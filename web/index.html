<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>mikrotik-dude-icons | Code Generator by HybridNetworks.com.ar</title>
  <meta name="description" content="Download the best icons to implement in your Mikrotik Dude monitoring." />
  <meta name="keywords" content="Mikrotik Dude, icons, HybridNetworks, script generator, dude icons, custom scripts, custom icons, RSC download, advanced tools, networking configurations, mikrotik, mikrotik the dude, the dude icons, svg" />

  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="favicon.png">

  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <!-- fontawesome.com - v6.7.2 -->
  <script src="https://kit.fontawesome.com/3f6895bc2f.js" crossorigin="anonymous"></script>

  <style>
    .image-item img {
      height: auto;
      margin-right: 10px;
      cursor: pointer;
    }
    .generated-code textarea {
      width: 100%;
      resize: none;
    }
    footer {
      margin-top: 20px;
      padding: 10px 0;
      background-color: #f8f9fa;
      text-align: center;
      font-size: 0.9rem;
      color: #6c757d;
    }
    .grid-min {
      background-image: url(./grid-min.svg);
    }
    .name-text {
      background-color: #FAFAFA;
    }
    .form-check-input[type=checkbox] {
      border-color: #000000;
    }
    .bg-up {
      background-image: linear-gradient(to bottom, #f4ffe9, #81ff03);
    }
    .bg-partial {
      background-image: linear-gradient(to bottom, #fff7f0, #ff8000);
    }
    .bg-complete {
      background-image: linear-gradient(to bottom, #fff7f7, #ff0303);
    }
    .bg-acked {
      background-image: linear-gradient(to bottom, #f3f9ff, #2b95ff);
    }
    .float-up {
      position: fixed;
      width: 60px;
      height: 60px;
      bottom: 5%;
      right: 40px;
      background-color: #6c757d;
      color: #FFF;
      border-radius: 50px;
      text-align: center;
      font-size: 30px;
      z-index: 100;
      display: none;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container py-4">
    <h1 class="text-center mb-4">mikrotik-dude-icons<br>Code Generator</h1>
    <div class="card shadow-sm p-4">
      <div class="mb-3">
        <label for="directory" class="form-label"><strong>1.- Installation directory of The Dude:</strong></label>
        <input type="text" id="directory" class="form-control" placeholder="Examples: dude, slot1-part1/dude, sata1/dude-data, etc." required>
      </div>
      <div class="mb-3">
        <label for="directory" class="form-label"><strong>2.- Select the images you require & Generate Code:</strong></label>
      </div>
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
          <button id="btnUp" class="btn bg-up">Up</button>
          <button id="btnPartial" class="btn bg-partial">Partial</button>
          <button id="btnComplete" class="btn bg-complete">Complete</button>
          <button id="btnAcked" class="btn bg-acked">Acked</button>
        </div>
        <div>
          <button id="selectAll" class="btn btn-secondary">Select All</button>
          <button id="deselectAll" class="btn btn-secondary">Deselect All</button>
        </div>
      </div>
      <div class="image-list row row-cols-2 g-3" id="imageList"></div>
      <div class="text-center mt-4">
        <button id="generateCode" class="btn btn-primary">Generate Code</button>
      </div>
      <div class="generated-code mt-4">
        <label for="outputCode" class="form-label"><strong>3.- Generated Code:</strong></label>
        <textarea id="outputCode" rows="8" class="form-control" readonly></textarea>
        <div class="d-flex justify-content-end mt-3">
          <button id="copyCode" class="btn btn-success me-2">Copy Code</button>
          <button id="downloadRsc" class="btn btn-info me-2 text-white">Download RSC</button>
          <button id="downloadZIPButton" class="btn btn-info text-white">Download ZIP</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <a href="https://mikrotik.com/" target="_blank"><img src="made-for-mikrotik.svg" alt="Made for Mikrotik" class="img"></a><br><br>
    &copy; <script type="text/javascript">var dt = new Date(); document.write(dt.getFullYear());</script> <a href="https://hybridnetworks.com.ar/" target="_blank" style="text-decoration: none;color: #0e0e10;"><strong>HybridNetworks Ltd.</strong></a> All rights reserved.
  </footer>

  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const baseImagePath = 'https://raw.githubusercontent.com/HybridNetworks/mikrotik-dude-icons/main/images/';

    async function loadImageList() {
      try {
        const response = await fetch('https://raw.githubusercontent.com/HybridNetworks/mikrotik-dude-icons/refs/heads/main/images_list.txt');
        const text = await response.text();
        const images = text.split('\n').map(line => line.trim()).filter(line => line);
        const imageListDiv = document.getElementById('imageList');

        images.forEach(image => {
          const div = document.createElement('div');
          div.className = 'col';
          const fileNameWithoutExtension = image.replace('.svg', ''); // Remove ".svg"

          div.innerHTML = `
            <div class="card h-100 grid-min">
              <div class="card-body d-flex align-items-center">
                <input type="checkbox" value="${image}" class="form-check-input me-2">
                <img src="${baseImagePath}${image}" alt="${image}" class="img-thumbnail me-3 bg-up">
                <span class="name-text">${fileNameWithoutExtension}</span>
              </div>
            </div>
          `;

          const imgElement = div.querySelector('img');
          const checkbox = div.querySelector('input[type="checkbox"]');

          imgElement.onload = () => {
            if (imgElement.naturalWidth <= 256) {
              imgElement.style.width = '128px';
            } else {
              imgElement.style.width = '256px';
            }
          };

          imgElement.addEventListener('click', () => {
            checkbox.checked = !checkbox.checked;
          });

          imageListDiv.appendChild(div);
        });
      } catch (error) {
        console.error('Error loading image list:', error);
      }
    }

    document.getElementById('generateCode').addEventListener('click', () => {
      const directory = document.getElementById('directory').value.trim();
      if (!directory) {
        showToast('Please enter a directory name.', 'warning');
        return;
      }

      const selectedImages = Array.from(document.querySelectorAll('#imageList input:checked'))
        .map(checkbox => checkbox.value);
      
      if (selectedImages.length === 0) {
        showToast('Please select at least one image.', 'warning');
        return;
      }

      const code = selectedImages.map(image => 
        `/tool fetch url=${baseImagePath}${image} mode=https dst-path=${directory}/files/images/${image} as-value;`
      ).join('\n');

      document.getElementById('outputCode').value = code;
    });

    var dty = new Date().getFullYear();

    // Generate RSC File
    const header = `# ============================================================
# (C) 2011-${dty} HybridNetworks Ltd. -- All Rights Reserved
#
# ABOUT CONTACT:
# HybridNetworks Ltd.
# info@hybridnetworks.com.ar
# https://hybridnetworks.com.ar
#
# Use this script only on the configured and supported device.
# PLEASE do not change, edit or modify any part of this script.
# PLEASE do not use on devices other than technical support.
# PLEASE do not remove this notice or your copyright.
#
# If you are a developer or consultant and want to incorporate 
# this script into your own products. PLEASE contact us to receive 
# permits under terms and conditions.
#
# ============================================================`;

    document.getElementById('downloadRsc').addEventListener('click', () => {
      const outputCode = document.getElementById('outputCode').value;
      if (!outputCode) {
        showToast('There is no code to download. Please generate the code first.', 'warning');
        return;
      }
      const content = `${header}\n${outputCode}`;
      const blob = new Blob([content], { type: 'text/plain' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'dude-icons.rsc';
      link.click();
    });

    document.getElementById('copyCode').addEventListener('click', () => {
      const outputCode = document.getElementById('outputCode');
      if (!outputCode.value.trim()) {
        showToast('No code to copy!', 'warning');
        return;
      }
      outputCode.select();
      document.execCommand('copy');
      showToast('Code copied to clipboard!', 'success');
    });

    const setBackgroundClass = (className) => {
      document.querySelectorAll('.img-thumbnail').forEach(card => {
        card.className = `img-thumbnail me-3 ${className}`;
      });
    };

    document.getElementById('btnUp').addEventListener('click', () => setBackgroundClass('bg-up'));
    document.getElementById('btnPartial').addEventListener('click', () => setBackgroundClass('bg-partial'));
    document.getElementById('btnComplete').addEventListener('click', () => setBackgroundClass('bg-complete'));
    document.getElementById('btnAcked').addEventListener('click', () => setBackgroundClass('bg-acked'));

    document.getElementById('selectAll').addEventListener('click', () => {
      document.querySelectorAll('#imageList input[type="checkbox"]').forEach(checkbox => checkbox.checked = true);
    });

    document.getElementById('deselectAll').addEventListener('click', () => {
      document.querySelectorAll('#imageList input[type="checkbox"]').forEach(checkbox => checkbox.checked = false);
    });

    loadImageList();

    function showToast(message, type = 'info') {
      const toastContainer = document.getElementById('toastContainer');
      
      const toast = document.createElement('div');
      toast.className = `toast align-items-center text-bg-${type} border-0`;
      toast.setAttribute('role', 'alert');
      toast.setAttribute('aria-live', 'assertive');
      toast.setAttribute('aria-atomic', 'true');
      
      toast.innerHTML = `
        <div class="d-flex">
          <div class="toast-body">
            ${message}
          </div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      `;
      
      toastContainer.appendChild(toast);

      const bootstrapToast = new bootstrap.Toast(toast);
      bootstrapToast.show();

      toast.addEventListener('hidden.bs.toast', () => {
        toast.remove();
      });
    }

    document.getElementById('downloadZIPButton').addEventListener('click', async () => {
      const selectedImages = Array.from(document.querySelectorAll('#imageList input:checked'))
        .map(checkbox => checkbox.value);

      if (selectedImages.length === 0) {
        showToast('Please select at least one image to download.', 'warning');
        return;
      }

      const zip = new JSZip();
      const imageFolder = zip.folder("images"); // Create a folder inside the ZIP for images

      const downloadPromises = selectedImages.map(async (imageName) => {
        const imageUrl = `${baseImagePath}${imageName}`;
        try {
          const response = await fetch(imageUrl);
          if (!response.ok) throw new Error(`Failed to fetch ${imageUrl}`);
          const blob = await response.blob();
          imageFolder.file(imageName, blob); // Add image to the ZIP folder
        } catch (error) {
          console.error(`Error downloading image: ${imageName}`, error);
        }
      });

      // Wait for all image downloads to complete
      await Promise.all(downloadPromises);

      // Generate ZIP and trigger download
      zip.generateAsync({ type: "blob" }).then((zipBlob) => {
        saveAs(zipBlob, "dude-icons.zip");
      }).catch(error => {
        console.error('Error generating ZIP file:', error);
      });
    });

    document.addEventListener('DOMContentLoaded', function() {
        const upTopButton = document.getElementById('upTop');
    
        // Funcionalidad del botón Up Top
        upTopButton.addEventListener('click', function(e) {
            e.preventDefault(); // Evitar el comportamiento por defecto del enlace
            window.scrollTo({ top: 0, behavior: 'smooth' }); // Desplazarse hacia arriba
            upTopButton.style.display = 'none'; // Ocultar el botón
        });

        // Ocultar el botón al llegar a la parte superior
        window.addEventListener('scroll', function() {
            if (window.scrollY === 0) {
                upTopButton.style.display = 'none'; // Ocultar el botón si estamos en la parte superior
            }
        });
        // Mostrar/Ocultar el botón al hacer scroll
        window.addEventListener('scroll', function() {
            if (window.scrollY > 100) { // Mostrar botón si se ha desplazado más de 100px
                upTopButton.style.display = 'block';
            } else {
                upTopButton.style.display = 'none'; // Ocultar si estamos cerca de la parte superior
            }
        });
    });
  </script>

<!-- Toast Container -->
<div id="toastContainer" class="toast-container position-fixed bottom-0 end-0 p-3">
</div>

<!-- Up Top -->
<a id="upTop" href="#" class="float-up">
  <i class="fa-solid fa-arrow-up" style="margin-top:16px;"></i>
</a>

</body>
</html>
